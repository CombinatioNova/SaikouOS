<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Saikou | Crypto Analysis</title>
    <meta name="description" content="Advanced Cryptanalysis and Decoding Suite." />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@400;700&family=Montserrat:wght@700;800&display=swap" rel="stylesheet" />

    <style>
        :root {
            --bg-main: #000000;
            --panel-bg: #0a0a0a;
            --border: #333333;
            --text-main: #ffffff;
            --accent-red: #ef4444;
            --accent-green: #10b981;
            --accent-yellow: #eab308;
        }

        body {
            background-color: var(--bg-main);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        /* Scrollbars */
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: #111; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #555; }

        /* Utilities */
        .min-panel { background-color: var(--panel-bg); border: 1px solid var(--border); border-radius: 8px; }
        .min-input { background-color: #000; border: 1px solid var(--border); color: white; border-radius: 6px; padding: 10px 12px; outline: none; transition: border-color 0.2s; }
        .min-input:focus { border-color: #666; }
        
        .min-btn { background: white; color: black; padding: 8px 16px; border-radius: 6px; font-weight: 600; font-size: 14px; transition: opacity 0.2s; border: none; cursor: pointer; }
        .min-btn:hover { opacity: 0.9; }
        
        .min-btn-outline { background: transparent; border: 1px solid var(--border); color: #ccc; padding: 8px 16px; border-radius: 6px; font-size: 14px; transition: all 0.2s; cursor: pointer; }
        .min-btn-outline:hover { border-color: #666; color: white; background: #111; }
        .min-btn-outline.active { background: white; color: black; border-color: white; }

        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Chart Bars */
        .bar-container { display: flex; align-items: flex-end; gap: 2px; height: 60px; }
        .freq-bar { background: #333; flex: 1; transition: height 0.3s, background-color 0.2s; border-radius: 1px 1px 0 0; }
        .freq-bar:hover { background: #fff; }

        /* Animations */
        @keyframes pulse-subtle { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .animate-pulse-slow { animation: pulse-subtle 3s infinite; }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-black/90 border-b border-[#222] px-4 py-4 backdrop-blur-md">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-2 h-2 bg-white rounded-full"></div>
                <div class="font-bold text-lg tracking-tight text-white">Saikou Tools <span class="text-gray-600 font-normal">/ Crypto</span></div>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto w-full px-4 py-8 grid grid-cols-1 lg:grid-cols-3 gap-6">
        
        <!-- LEFT COLUMN: Input & Controls -->
        <div class="lg:col-span-2 space-y-6">
            
            <div class="min-panel p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-white">Cipher Stream</h2>
                    <span id="char-count" class="text-xs font-mono text-gray-500">LEN: 0</span>
                </div>

                <!-- Tabs -->
                <div class="flex gap-2 mb-4 border-b border-[#333] pb-4">
                    <button onclick="setMode('auto')" id="tab-auto" class="min-btn-outline active text-xs uppercase tracking-wide"><i class="fas fa-magic mr-2"></i>Auto-Crack</button>
                    <button onclick="setMode('manual')" id="tab-manual" class="min-btn-outline text-xs uppercase tracking-wide"><i class="fas fa-sliders-h mr-2"></i>Manual Tools</button>
                </div>

                <textarea id="ciphertext" class="min-input w-full h-32 resize-y font-mono text-sm mb-4" placeholder="// Enter encrypted data sequence here..."></textarea>

                <!-- Manual Controls (Hidden by default) -->
                <div id="manual-controls" class="hidden mb-4 p-4 bg-[#111] border border-[#333] rounded-md">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-[10px] uppercase text-gray-500 mb-1 font-bold">Algorithm</label>
                            <select id="cipher-select" class="min-input w-full text-sm py-2">
                                <option value="caesar">Caesar / Shift (Brute Force)</option>
                                <option value="vigenere">Vigenère (Key Required)</option>
                                <option value="railfence">Rail Fence (Brute Force)</option>
                                <option value="atbash">Atbash Substitution</option>
                                <option value="base64">Base64 Decode</option>
                                <option value="hex">Hex -> ASCII</option>
                            </select>
                        </div>
                        <div id="key-input-container" class="hidden">
                            <label class="block text-[10px] uppercase text-gray-500 mb-1 font-bold">Decryption Key</label>
                            <input type="text" id="cipher-key" class="min-input w-full text-sm py-2" placeholder="e.g. SECRET">
                        </div>
                    </div>
                </div>

                <div class="flex gap-2 flex-wrap">
                    <button onclick="runDecryption()" class="min-btn flex-1"><i class="fas fa-unlock-alt mr-2"></i>Decrypt Stream</button>
                    <button onclick="pasteFromClipboard()" class="min-btn-outline text-xs"><i class="fas fa-paste mr-1"></i>Paste</button>
                    <button onclick="clearAll()" class="min-btn-outline text-xs text-red-400 hover:text-red-300 hover:border-red-900"><i class="fas fa-trash mr-1"></i>Clear</button>
                </div>
            </div>

            <!-- Results Area -->
            <div class="min-panel p-6 min-h-[400px] flex flex-col">
                <div class="flex justify-between items-center mb-6 border-b border-[#333] pb-2">
                    <h3 class="text-sm font-bold text-white uppercase flex items-center gap-2"><i class="fas fa-terminal text-gray-500"></i> Decryption Output</h3>
                    <span id="status-text" class="text-[10px] font-mono text-gray-500 animate-pulse-slow">READY</span>
                </div>
                
                <div id="results-area" class="space-y-3 custom-scroll overflow-y-auto flex-1 max-h-[600px] pr-2">
                    <div class="flex flex-col items-center justify-center h-40 text-gray-600">
                        <i class="fas fa-code text-3xl mb-2 opacity-20"></i>
                        <span class="text-xs">Waiting for input stream...</span>
                    </div>
                </div>
            </div>

        </div>

        <!-- RIGHT COLUMN: Analysis -->
        <div class="space-y-6">
            
            <!-- Intelligence Panel -->
            <div class="min-panel p-6 border-l-2 border-blue-600">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-bold text-white">Heuristics</h3>
                        <div class="text-xs font-mono mt-1 text-gray-500 uppercase tracking-widest">Language Detection</div>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-[#111] p-3 rounded border border-[#333]">
                        <div class="text-[10px] text-gray-500 uppercase font-bold mb-1">Certainty</div>
                        <div id="lang-score" class="text-sm font-bold text-white">--</div>
                    </div>
                    <div class="bg-[#111] p-3 rounded border border-[#333]">
                        <div class="text-[10px] text-gray-500 uppercase font-bold mb-1">Prediction</div>
                        <div id="likely-cipher" class="text-sm font-bold text-white">--</div>
                    </div>
                </div>

                <div class="mb-2 flex justify-between items-end">
                    <span class="text-xs font-bold text-gray-400">Coincidence Index (IoC)</span>
                    <span id="ioc-score" class="text-lg font-mono font-bold text-white">0.000</span>
                </div>
                <!-- IoC Bar -->
                <div class="w-full bg-[#222] h-1.5 rounded-full overflow-hidden relative mb-1">
                    <div id="ioc-bar" class="h-full bg-blue-500 transition-all duration-500" style="width: 0%"></div>
                    <!-- Marker for English (1.73 approx mapped to scale) -->
                    <div class="absolute top-0 bottom-0 w-0.5 bg-white opacity-50" style="left: 66%" title="English Standard (~1.73)"></div>
                </div>
                <div class="flex justify-between text-[9px] text-gray-600 font-mono">
                    <span>RANDOM (1.0)</span>
                    <span>ENGLISH (1.73)</span>
                </div>
            </div>

            <!-- Frequency Analysis -->
            <div class="min-panel p-6">
                <h3 class="text-xs font-bold text-gray-500 uppercase mb-4 flex items-center gap-2">
                    <i class="fas fa-chart-bar"></i> Frequency Analysis
                </h3>
                
                <div id="freq-chart" class="bar-container mb-2 border-b border-[#333]">
                    <!-- Bars injected JS -->
                </div>
                <div class="flex justify-between text-[9px] text-gray-600 font-mono px-1">
                    <span>A</span>
                    <span>M</span>
                    <span>Z</span>
                </div>
            </div>

            <!-- Quick Reference -->
            <div class="min-panel p-5 bg-[#111]">
                <h3 class="text-xs font-bold text-gray-500 uppercase mb-3">Module Capabilities</h3>
                <ul class="space-y-2 text-xs text-gray-400">
                    <li class="flex items-center gap-2"><i class="fas fa-check text-green-500"></i> <span>Auto-Detects English plaintext</span></li>
                    <li class="flex items-center gap-2"><i class="fas fa-check text-green-500"></i> <span>Brute-force Caesar (26 shifts)</span></li>
                    <li class="flex items-center gap-2"><i class="fas fa-check text-green-500"></i> <span>Brute-force Rail Fence (2-10)</span></li>
                    <li class="flex items-center gap-2"><i class="fas fa-check text-green-500"></i> <span>Encodings (Base64, Hex, Binary)</span></li>
                </ul>
            </div>

        </div>
    </main>

    <script>
        // --- CONFIG ---
        const ENG_FREQ = {
            'a': 8.167, 'b': 1.492, 'c': 2.782, 'd': 4.253, 'e': 12.702, 'f': 2.228,
            'g': 2.015, 'h': 6.094, 'i': 6.966, 'j': 0.153, 'k': 0.772, 'l': 4.025,
            'm': 2.406, 'n': 6.749, 'o': 7.507, 'p': 1.929, 'q': 0.095, 'r': 5.987,
            's': 6.327, 't': 9.056, 'u': 2.758, 'v': 0.978, 'w': 2.360, 'x': 0.150,
            'y': 1.974, 'z': 0.074
        };
        // Expanded Dictionary for better detection
        const COMMON_WORDS = new Set([
            // Articles, Pronouns, Prepositions
            "the","be","to","of","and","a","in","that","have","i","it","for","not","on","with","he","as","you","do","at","this","but","his","by","from","they","we","say","her","she","or","an","will","my","one","all","would","there","their","what","so","up","out","if","about","who","get","which","go","me","when","make","can","like","time","no","just","him","know","take","people","into","year","your","good","some","could","them","see","other","than","then","now","look","only","come","its","over","think","also","back","after","use","two","how","our","work","first","well","way","even","new","want","because","any","these","give","day","most","us",
            // Common Verbs & Nouns
            "is","are","was","were","been","has","had","do","does","did","done","said","says","went","gone","made","make","know","known","thought","think","take","taken","saw","seen","come","came","put","set","found","find","told","tell","ask","asked","seem","seemed","feel","felt","try","tried","leave","left","call","called",
            "time","person","year","way","day","thing","man","world","life","hand","part","child","eye","woman","place","work","week","case","point","government","company","number","group","problem","fact",
            // Adjectives
            "big","high","different","small","large","next","early","young","important","few","public","bad","same","able",
            // Tech / Crypto / CTF Specific
            "flag","secret","password","code","admin","root","login","user","username","pass","key","token","auth","session","cookie","hidden","message","encrypted","cipher","text","string","hash","value","data","system","access","denied","granted","success","fail","error","warning","level","stage","phase","clue","hint","solve","solution","answer","correct","wrong","true","false","null","void","return","function","var","let","const","class","import","export","from",
            // Gaming / Roblox / Platform Specific
            "roblox","rbx","robux","dev","developer","studio","script","lua","exploit","hack","cheat","banned","ban","kick","server","client","obby","tycoon","simulator","roleplay","rp","avatar","skin","item","trade","limited","ugc","group","clan","raid","alt","main","smurf","discord","cord","disc","vc","voice","chat","mod","admin","owner","creator","builder","gui",
            // Safety / Moderation / Flagged Terms (Predator Behavior Indicators)
            "age","old","young","boy","girl","pic","picture","photo","snap","insta","kik","meet","irl","real","life","address","school","live","where","location","send","nude","sexy","hot","cute","love","baby","daddy","mommy","secret","private","dm","pm","message","hidden","room","house","bed","sleep","touch","kiss","trust","promise","video","cam","webcam","naked","body"
        ]);

        // --- DOM HELPERS ---
        const $ = id => document.getElementById(id);

        // --- ANALYSIS ENGINE ---
        function cleanStr(str) { return str.toLowerCase().replace(/[^a-z]/g, ""); }

        function calculateIoC(text) {
            const clean = cleanStr(text);
            const len = clean.length;
            if (len <= 1) return 0;
            const counts = {};
            for (let char of clean) counts[char] = (counts[char] || 0) + 1;
            let numerator = 0;
            for (let char in counts) numerator += counts[char] * (counts[char] - 1);
            return (numerator / (len * (len - 1))) * 26; 
        }

        function scoreText(text) {
            if (!text || text.length === 0) return -100;
            const lower = text.toLowerCase();
            const words = lower.split(/[\s,.-]+/);
            let wordScore = 0;
            
            words.forEach(w => {
                if (w.length > 1 && COMMON_WORDS.has(w)) wordScore += 10;
            });

            const clean = cleanStr(text);
            if (clean.length === 0) return -50;
            
            const counts = {};
            for (let c of clean) counts[c] = (counts[c] || 0) + 1;
            let chiSquared = 0;
            for (let char in ENG_FREQ) {
                const observed = counts[char] || 0;
                const expected = (ENG_FREQ[char] / 100) * clean.length;
                chiSquared += Math.pow(observed - expected, 2) / expected;
            }

            let finalScore = (wordScore * 2) - (chiSquared / 2);
            if (text.includes(" ")) finalScore += 5;
            return finalScore;
        }

        // --- CIPHERS ---
        function decryptCaesar(text, shift) {
            return text.replace(/[a-zA-Z]/g, char => {
                const base = char <= 'Z' ? 65 : 97;
                return String.fromCharCode(((char.charCodeAt(0) - base - shift + 26) % 26) + base);
            });
        }

        function decryptAtbash(text) {
            return text.replace(/[a-zA-Z]/g, char => {
                const base = char <= 'Z' ? 65 : 97;
                return String.fromCharCode(base + (25 - (char.charCodeAt(0) - base)));
            });
        }

        function decryptRailFence(text, rails) {
            const clean = text.replace(/\r?\n|\r/g, '');
            if (clean.length === 0 || rails <= 1) return clean;
            const cycle = 2 * (rails - 1);
            const len = clean.length;
            const fence = new Array(rails).fill(0).map(() => []);
            const railCounts = new Array(rails).fill(0);
            
            for (let i = 0; i < len; i++) {
                const pos = i % cycle;
                const row = pos < rails ? pos : cycle - pos;
                railCounts[row]++;
            }

            let index = 0;
            for (let r = 0; r < rails; r++) {
                for (let c = 0; c < railCounts[r]; c++) {
                    if (index < len) fence[r].push(clean[index++]);
                }
            }

            let result = "";
            const railIndices = new Array(rails).fill(0);
            for (let i = 0; i < len; i++) {
                const pos = i % cycle;
                const row = pos < rails ? pos : cycle - pos;
                if (fence[row][railIndices[row]]) {
                    result += fence[row][railIndices[row]];
                    railIndices[row]++;
                }
            }
            return result;
        }

        function decryptVigenere(text, key) {
            if (!key) return text;
            const cleanKey = cleanStr(key);
            if (cleanKey.length === 0) return text;
            let ki = 0;
            return text.replace(/[a-zA-Z]/g, char => {
                const base = char <= 'Z' ? 65 : 97;
                const kChar = cleanKey[ki % cleanKey.length];
                const shift = kChar.charCodeAt(0) - 97;
                const val = char.charCodeAt(0) - base;
                ki++;
                return String.fromCharCode(((val - shift + 26) % 26) + base);
            });
        }

        // --- UI LOGIC ---
        function analyzeInput() {
            const text = $('ciphertext').value;
            if(!text) { 
                $('freq-chart').innerHTML = ''; 
                $('ioc-score').innerText = '0.000';
                $('ioc-bar').style.width = '0%';
                return; 
            }
            
            $('char-count').innerText = `LEN: ${text.length}`;
            
            // Chart
            const clean = cleanStr(text);
            const counts = {};
            for(let c of clean) counts[c] = (counts[c]||0) + 1;
            const max = Math.max(...Object.values(counts), 1);
            
            const chartHtml = Object.keys(ENG_FREQ).map(char => {
                const h = ((counts[char] || 0) / max) * 100;
                const color = (['e','t','a','o','i','n'].includes(char)) ? '#fff' : '#333';
                return `<div class="freq-bar" style="height:${h}%; background-color:${color}" title="${char.toUpperCase()}: ${counts[char]||0}"></div>`;
            }).join('');
            $('freq-chart').innerHTML = chartHtml;

            // IoC
            const ioc = calculateIoC(text);
            $('ioc-score').innerText = ioc.toFixed(3);
            
            // Visual IoC Bar (Scale: 1.0 to 2.0 roughly)
            let width = 0;
            if(ioc > 0.9) width = Math.min(100, Math.max(0, (ioc - 0.9) * 80)); // Scale logic
            $('ioc-bar').style.width = `${width}%`;

            let likely = "Unknown";
            let color = "text-gray-500";
            
            if(ioc > 1.5) { likely = "Monoalphabetic (Sub)"; color = "text-yellow-500"; }
            else if (ioc < 1.0) { likely = "Poly/Random"; color = "text-red-500"; }
            else { likely = "Vigenère/Mixed"; color = "text-blue-400"; }
            
            if(/^[0-9A-Fa-f\s]+$/.test(text) && text.length > 8) { likely = "Hexadecimal"; color = "text-green-500"; }
            if(/^[A-Za-z0-9+/=]+$/.test(text) && text.endsWith('=')) { likely = "Base64"; color = "text-green-500"; }
            if(/^[01\s]+$/.test(text) && text.length > 8) { likely = "Binary"; color = "text-green-500"; }

            $('likely-cipher').innerHTML = `<span class="${color}">${likely}</span>`;
        }

        function runDecryption() {
            const input = $('ciphertext').value;
            const mode = document.querySelector('#tab-auto').classList.contains('active') ? 'auto' : 'manual';
            const resultsDiv = $('results-area');
            
            if (!input.trim()) {
                resultsDiv.innerHTML = `<div class="text-center text-red-500 text-xs mt-10"><i class="fas fa-exclamation-triangle mr-2"></i>Input buffer empty</div>`;
                return;
            }

            analyzeInput();
            $('status-text').innerText = "PROCESSING...";
            resultsDiv.innerHTML = '';

            let attempts = [];

            if (mode === "auto") {
                // Encodings
                try { attempts.push({ method: "Base64", text: atob(input), score: scoreText(atob(input)) + 20 }); } catch(e){}
                
                // Hex
                const cleanHex = input.replace(/\s/g, '');
                if(/^[0-9A-Fa-f]+$/.test(cleanHex) && cleanHex.length % 2 === 0) {
                    let str = '';
                    for (let i = 0; i < cleanHex.length; i += 2) str += String.fromCharCode(parseInt(cleanHex.substr(i, 2), 16));
                    attempts.push({ method: "Hex to ASCII", text: str, score: scoreText(str) + 20 });
                }

                // Algorithms
                const atb = decryptAtbash(input);
                attempts.push({ method: "Atbash", text: atb, score: scoreText(atb) });

                for(let s=1; s<26; s++) {
                    const res = decryptCaesar(input, s);
                    attempts.push({ method: `Caesar (-${s})`, text: res, score: scoreText(res) });
                }

                for(let r=2; r<=10; r++) {
                    const res = decryptRailFence(input, r);
                    attempts.push({ method: `Rail Fence (${r} Rails)`, text: res, score: scoreText(res) });
                }
            } else {
                // Manual
                const type = $('cipher-select').value;
                if(type === 'caesar') {
                    for(let s=1; s<26; s++) attempts.push({ method: `Caesar -${s}`, text: decryptCaesar(input, s), score: 0 });
                } else if (type === 'vigenere') {
                    const key = $('cipher-key').value;
                    if(!key) { alert("Key required"); return; }
                    attempts.push({ method: `Vigenère (${key})`, text: decryptVigenere(input, key), score: 100 });
                } else if (type === 'railfence') {
                    for(let r=2; r<=15; r++) attempts.push({ method: `Rail Fence (${r})`, text: decryptRailFence(input, r), score: 0 });
                } else if (type === 'atbash') attempts.push({ method: "Atbash", text: decryptAtbash(input), score: 100 });
                else if (type === 'base64') { try { attempts.push({ method: "Base64", text: atob(input), score: 100 }); } catch(e){}}
                
                // Re-score manual attempts just for badges
                attempts.forEach(a => a.score = scoreText(a.text));
            }

            // Sort & Render
            attempts.sort((a, b) => b.score - a.score);
            
            if(attempts.length > 0) {
                // Update Language confidence based on top result
                const top = attempts[0].score;
                let lText = "Unknown"; let lColor = "text-gray-500";
                if(top > 30) { lText = "High (English)"; lColor = "text-green-500"; }
                else if(top > 10) { lText = "Moderate"; lColor = "text-yellow-500"; }
                else { lText = "Low / Gibberish"; lColor = "text-red-500"; }
                $('lang-score').innerHTML = `<span class="${lColor}">${lText}</span>`;
            }

            attempts.slice(0, 30).forEach(att => {
                // Confidence Badge Logic
                let badge = '';
                let border = 'border-[#333]';
                if(att.score > 25) {
                    badge = `<span class="text-[9px] bg-green-900/20 text-green-500 border border-green-900 px-2 py-0.5 rounded font-bold">HIGH MATCH</span>`;
                    border = 'border-green-900/50';
                } else if(att.score > 5) {
                    badge = `<span class="text-[9px] bg-yellow-900/20 text-yellow-500 border border-yellow-900 px-2 py-0.5 rounded font-bold">POSSIBLE</span>`;
                } else {
                    badge = `<span class="text-[9px] bg-[#222] text-gray-500 border border-[#333] px-2 py-0.5 rounded">LOW</span>`;
                }

                const div = document.createElement('div');
                div.className = `bg-[#0e0e0e] border ${border} rounded p-3 hover:bg-[#151515] transition-colors group`;
                div.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-xs font-bold text-gray-300 uppercase">${att.method}</span>
                        ${badge}
                    </div>
                    <div class="font-mono text-xs text-gray-400 break-all leading-relaxed group-hover:text-white cursor-text select-text">${escapeHtml(att.text)}</div>
                `;
                resultsDiv.appendChild(div);
            });

            $('status-text').innerText = `COMPLETE (${attempts.length})`;
        }

        function setMode(mode) {
            if(mode === 'auto') {
                $('tab-auto').classList.add('active');
                $('tab-manual').classList.remove('active');
                $('manual-controls').classList.add('hidden');
            } else {
                $('tab-auto').classList.remove('active');
                $('tab-manual').classList.add('active');
                $('manual-controls').classList.remove('hidden');
            }
        }

        function clearAll() {
            $('ciphertext').value = '';
            $('results-area').innerHTML = `<div class="flex flex-col items-center justify-center h-40 text-gray-600"><i class="fas fa-code text-3xl mb-2 opacity-20"></i><span class="text-xs">Waiting for input stream...</span></div>`;
            $('char-count').innerText = "LEN: 0";
            $('freq-chart').innerHTML = '';
            $('ioc-bar').style.width = '0%';
            $('ioc-score').innerText = '0.000';
        }

        $('cipher-select').addEventListener('change', (e) => {
            $('key-input-container').style.display = e.target.value === 'vigenere' ? 'block' : 'none';
        });

        $('ciphertext').addEventListener('input', analyzeInput);

        async function pasteFromClipboard() {
            try {
                const t = await navigator.clipboard.readText();
                $('ciphertext').value = t;
                analyzeInput();
            } catch(e){ alert("Clipboard access denied"); }
        }

        function escapeHtml(text) {
            return text ? text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;") : '';
        }
    </script>
</body>
</html>